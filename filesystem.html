

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Filesystem &mdash; buvis-gems  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=9edc463e" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=5929fcd5"></script>
      <script src="_static/doctools.js?v=fd6eb6e6"></script>
      <script src="_static/sphinx_highlight.js?v=6ffebe34"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Adapters" href="adapters.html" />
    <link rel="prev" title="Formatting" href="formatting.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            buvis-gems
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Library:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html#api-reference">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="formatting.html">Formatting</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Filesystem</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#quick-start">Quick Start</a></li>
<li class="toctree-l2"><a class="reference internal" href="#api-reference">API Reference</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#dirtree">DirTree</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#buvis.pybase.filesystem.DirTree"><code class="docutils literal notranslate"><span class="pre">DirTree</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#filemetadatareader">FileMetadataReader</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#buvis.pybase.filesystem.FileMetadataReader"><code class="docutils literal notranslate"><span class="pre">FileMetadataReader</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#examples">Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#dirtree-example">DirTree Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="#filemetadatareader-example">FileMetadataReader Example</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="adapters.html">Adapters</a></li>
<li class="toctree-l1"><a class="reference internal" href="zettel.html">Zettel</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">CLI Tools:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tools.html">CLI Tools</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contributing:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="development.html">Development</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">buvis-gems</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Filesystem</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/filesystem.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="filesystem">
<h1>Filesystem<a class="headerlink" href="#filesystem" title="Link to this heading"></a></h1>
<p>Utilities for directory traversal, file metadata, and batch operations.</p>
<nav class="contents local" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#overview" id="id1">Overview</a></p></li>
<li><p><a class="reference internal" href="#quick-start" id="id2">Quick Start</a></p></li>
<li><p><a class="reference internal" href="#api-reference" id="id3">API Reference</a></p>
<ul>
<li><p><a class="reference internal" href="#dirtree" id="id4">DirTree</a></p></li>
<li><p><a class="reference internal" href="#filemetadatareader" id="id5">FileMetadataReader</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#examples" id="id6">Examples</a></p>
<ul>
<li><p><a class="reference internal" href="#dirtree-example" id="id7">DirTree Example</a></p></li>
<li><p><a class="reference internal" href="#filemetadatareader-example" id="id8">FileMetadataReader Example</a></p></li>
</ul>
</li>
</ul>
</nav>
<section id="overview">
<h2><a class="toc-backref" href="#id1" role="doc-backlink">Overview</a><a class="headerlink" href="#overview" title="Link to this heading"></a></h2>
<p><cite>DirTree</cite> and <cite>FileMetadataReader</cite> are static utility classes under
<cite>buvis.pybase.filesystem</cite>. Each exposes class-level helpers—no
instantiation is required—to inspect directory depth, prune files, or read
timestamps. DirTree bundles cleanup routines (counting files, normalizing
extensions, removing empty folders, and merging Mac metadata), while
FileMetadataReader surfaces creation and first-commit datetimes with
platform-aware fallbacks.</p>
</section>
<section id="quick-start">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Quick Start</a><a class="headerlink" href="#quick-start" title="Link to this heading"></a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">buvis.pybase.filesystem</span><span class="w"> </span><span class="kn">import</span> <span class="n">DirTree</span><span class="p">,</span> <span class="n">FileMetadataReader</span>

<span class="n">project_root</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span>

<span class="c1"># Static utilities: no DirTree() or FileMetadataReader() instantiation.</span>
<span class="n">total_files</span> <span class="o">=</span> <span class="n">DirTree</span><span class="o">.</span><span class="n">count_files</span><span class="p">(</span><span class="n">project_root</span> <span class="o">/</span> <span class="s2">&quot;src&quot;</span><span class="p">)</span>
<span class="n">creation_dt</span> <span class="o">=</span> <span class="n">FileMetadataReader</span><span class="o">.</span><span class="n">get_creation_datetime</span><span class="p">(</span><span class="n">project_root</span> <span class="o">/</span> <span class="s2">&quot;pyproject.toml&quot;</span><span class="p">)</span>
<span class="n">first_commit</span> <span class="o">=</span> <span class="n">FileMetadataReader</span><span class="o">.</span><span class="n">get_first_commit_datetime</span><span class="p">(</span><span class="n">project_root</span> <span class="o">/</span> <span class="s2">&quot;pyproject.toml&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">total_files</span><span class="p">,</span> <span class="n">creation_dt</span><span class="p">,</span> <span class="n">first_commit</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="api-reference">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">API Reference</a><a class="headerlink" href="#api-reference" title="Link to this heading"></a></h2>
<section id="dirtree">
<h3><a class="toc-backref" href="#id4" role="doc-backlink">DirTree</a><a class="headerlink" href="#dirtree" title="Link to this heading"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="buvis.pybase.filesystem.DirTree">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">buvis.pybase.filesystem.</span></span><span class="sig-name descname"><span class="pre">DirTree</span></span><a class="headerlink" href="#buvis.pybase.filesystem.DirTree" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Utility with static directory operations.</p>
<p>Provides static methods for counting files, cleanup routines, and normalization
helpers. No instantiation is required.</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">buvis.pybase.filesystem</span><span class="w"> </span><span class="kn">import</span> <span class="n">DirTree</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">count</span> <span class="o">=</span> <span class="n">DirTree</span><span class="o">.</span><span class="n">count_files</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="s1">&#39;/data&#39;</span><span class="p">))</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="buvis.pybase.filesystem.DirTree.count_files">
<span class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">count_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">directory</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="headerlink" href="#buvis.pybase.filesystem.DirTree.count_files" title="Link to this definition"></a></dt>
<dd><p>Count the number of files in the directory and its subdirectories.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>directory</strong> – Path to the directory to process.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Number of files in the directory and its subdirectories.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="buvis.pybase.filesystem.DirTree.delete_by_extension">
<span class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">delete_by_extension</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">directory</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extensions_to_delete</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#buvis.pybase.filesystem.DirTree.delete_by_extension" title="Link to this definition"></a></dt>
<dd><p>Delete files with specific extensions in the given directory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>directory</strong> – Path to the directory to process.</p></li>
<li><p><strong>extensions_to_delete</strong> – List of file extensions to delete.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None. The function modifies the directory in place.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="buvis.pybase.filesystem.DirTree.get_max_depth">
<span class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">get_max_depth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">directory</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="headerlink" href="#buvis.pybase.filesystem.DirTree.get_max_depth" title="Link to this definition"></a></dt>
<dd><p>Determine the maximum depth of the directory tree.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>directory</strong> – Path to the directory to process.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Maximum depth of the directory tree.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="buvis.pybase.filesystem.DirTree.merge_mac_metadata">
<span class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">merge_mac_metadata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">directory</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#buvis.pybase.filesystem.DirTree.merge_mac_metadata" title="Link to this definition"></a></dt>
<dd><p>Restore macOS metadata from AppleDouble helper files.</p>
<p>Walks the directory tree for AppleDouble files (._*) and, when not on
Windows, applies their extended attributes back to the corresponding
originals before cleaning up any orphaned helper files. This serves as
a post-copy cleanup for macOS metadata files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>directory</strong> – Directory containing files and AppleDouble metadata.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="buvis.pybase.filesystem.DirTree.normalize_file_extensions">
<span class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">normalize_file_extensions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">directory</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#buvis.pybase.filesystem.DirTree.normalize_file_extensions" title="Link to this definition"></a></dt>
<dd><p>Normalize file extensions in the given directory:
1) lowercase the extensions
2) replace equivalents</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>directory</strong> – Path to the directory to process.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None. The function modifies the directory in place.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="buvis.pybase.filesystem.DirTree.remove_empty_directories">
<span class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">remove_empty_directories</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">directory</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#buvis.pybase.filesystem.DirTree.remove_empty_directories" title="Link to this definition"></a></dt>
<dd><p>Recursively remove all empty directories.</p>
<p>Traverses bottom-up to remove directories that become empty
after their children are removed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>directory</strong> – Root directory to clean.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Modifies the directory tree in place. Non-empty directories
and files are preserved.</p>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="filemetadatareader">
<h3><a class="toc-backref" href="#id5" role="doc-backlink">FileMetadataReader</a><a class="headerlink" href="#filemetadatareader" title="Link to this heading"></a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="buvis.pybase.filesystem.FileMetadataReader">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">buvis.pybase.filesystem.</span></span><span class="sig-name descname"><span class="pre">FileMetadataReader</span></span><a class="headerlink" href="#buvis.pybase.filesystem.FileMetadataReader" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Utility reader that exposes static helpers for file metadata.</p>
<p>The class is not meant to be instantiated; callers just need to invoke the
static helpers to obtain timestamps such as the file creation datetime or
the first commit datetime in a Git repository. Creation-time resolution is
platform specific (Windows uses <cite>st_ctime</cite> while Unix systems prefer
<cite>st_birthtime</cite> with a fallback to modification time).</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">FileMetadataReader</span><span class="o">.</span><span class="n">get_creation_datetime</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;example.txt&quot;</span><span class="p">))</span>
<span class="go">datetime(2024, 7, 8, 12, 34, tzinfo=...)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="buvis.pybase.filesystem.FileMetadataReader.get_creation_datetime">
<span class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">get_creation_datetime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">datetime</span></span></span><a class="headerlink" href="#buvis.pybase.filesystem.FileMetadataReader.get_creation_datetime" title="Link to this definition"></a></dt>
<dd><p>Retrieve the creation date of a file, falling back to modification date if creation date is unavailable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file_path</strong> (<em>Path</em>) – Path to the file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Datetime when file was created.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>datetime</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="buvis.pybase.filesystem.FileMetadataReader.get_first_commit_datetime">
<span class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">get_first_commit_datetime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">datetime</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="headerlink" href="#buvis.pybase.filesystem.FileMetadataReader.get_first_commit_datetime" title="Link to this definition"></a></dt>
<dd><p>Retrieve the date a file was first added to a Git repository located at the parent directory of file_path.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file_path</strong> (<em>Path</em>) – Path to the file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Datetime of the first commit involving the file</dt><dd><p>or None if the file wasn’t committed to any Git repository.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>datatime | None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="examples">
<h2><a class="toc-backref" href="#id6" role="doc-backlink">Examples</a><a class="headerlink" href="#examples" title="Link to this heading"></a></h2>
<section id="dirtree-example">
<h3><a class="toc-backref" href="#id7" role="doc-backlink">DirTree Example</a><a class="headerlink" href="#dirtree-example" title="Link to this heading"></a></h3>
<p>Use <cite>DirTree</cite> to profile and clean a release artifact directory before publishing.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">buvis.pybase.filesystem</span><span class="w"> </span><span class="kn">import</span> <span class="n">DirTree</span>

<span class="n">project_root</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span>
<span class="n">artifacts_dir</span> <span class="o">=</span> <span class="n">project_root</span> <span class="o">/</span> <span class="s2">&quot;dist&quot;</span> <span class="o">/</span> <span class="s2">&quot;artifacts&quot;</span>

<span class="n">file_count</span> <span class="o">=</span> <span class="n">DirTree</span><span class="o">.</span><span class="n">count_files</span><span class="p">(</span><span class="n">artifacts_dir</span><span class="p">)</span>
<span class="n">max_depth</span> <span class="o">=</span> <span class="n">DirTree</span><span class="o">.</span><span class="n">get_max_depth</span><span class="p">(</span><span class="n">artifacts_dir</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Artifact tree: </span><span class="si">{</span><span class="n">file_count</span><span class="si">}</span><span class="s2"> files across </span><span class="si">{</span><span class="n">max_depth</span><span class="si">}</span><span class="s2"> levels.&quot;</span><span class="p">)</span>

<span class="n">DirTree</span><span class="o">.</span><span class="n">delete_by_extension</span><span class="p">(</span><span class="n">artifacts_dir</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;.tmp&quot;</span><span class="p">,</span> <span class="s2">&quot;.log&quot;</span><span class="p">])</span>
<span class="n">DirTree</span><span class="o">.</span><span class="n">normalize_file_extensions</span><span class="p">(</span><span class="n">artifacts_dir</span><span class="p">)</span>
<span class="n">DirTree</span><span class="o">.</span><span class="n">remove_empty_directories</span><span class="p">(</span><span class="n">artifacts_dir</span><span class="p">)</span>
<span class="n">DirTree</span><span class="o">.</span><span class="n">merge_mac_metadata</span><span class="p">(</span><span class="n">artifacts_dir</span><span class="p">)</span>

<span class="c1"># The cleanup routine removes stray caches, coerces extensions to the</span>
<span class="c1"># project standard, prunes empty folders, and restores macOS metadata.</span>
</pre></div>
</div>
</section>
<section id="filemetadatareader-example">
<h3><a class="toc-backref" href="#id8" role="doc-backlink">FileMetadataReader Example</a><a class="headerlink" href="#filemetadatareader-example" title="Link to this heading"></a></h3>
<p><cite>FileMetadataReader</cite> can guard metadata-dependent builds while accounting for
non-git working trees.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">buvis.pybase.filesystem</span><span class="w"> </span><span class="kn">import</span> <span class="n">FileMetadataReader</span>

<span class="n">project_root</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span>
<span class="n">config_file</span> <span class="o">=</span> <span class="n">project_root</span> <span class="o">/</span> <span class="s2">&quot;pyproject.toml&quot;</span>

<span class="n">created</span> <span class="o">=</span> <span class="n">FileMetadataReader</span><span class="o">.</span><span class="n">get_creation_datetime</span><span class="p">(</span><span class="n">config_file</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">config_file</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> born at </span><span class="si">{</span><span class="n">created</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">first_commit</span> <span class="o">=</span> <span class="n">FileMetadataReader</span><span class="o">.</span><span class="n">get_first_commit_datetime</span><span class="p">(</span><span class="n">config_file</span><span class="p">)</span>
<span class="k">if</span> <span class="n">first_commit</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">config_file</span><span class="si">}</span><span class="s2"> lives outside a Git repository; commit metadata unavailable.&quot;</span>
    <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;First commit touching </span><span class="si">{</span><span class="n">config_file</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> occurred on </span><span class="si">{</span><span class="n">first_commit</span><span class="o">.</span><span class="n">date</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="formatting.html" class="btn btn-neutral float-left" title="Formatting" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="adapters.html" class="btn btn-neutral float-right" title="Adapters" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024-2026, Tomáš Bouška.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>